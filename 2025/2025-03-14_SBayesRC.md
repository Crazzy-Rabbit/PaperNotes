### 📄  Leveraging functional genomic annotations and genome coverage to improve polygenic prediction of complex traits within and between ancestries

**原文链接**: https://www.nature.com/articles/s41588-024-01704-y （DOI: 10.1038/s41588-024-01704-y） \
**作者**: Zhili Zheng, Shouye Liu, Julia Sidorenko, et al. \
**期刊**: *Nat Genet*, 2024 \
**关键词**: polygenic prediction, functional genomic annotation, cross-ancestry prediction, Bayesian multiple regression, SNP density, annotation interaction

---
![1760683648956](image/2025-03-14_SBayesRC/1760683648956.png)
## 🧠 一、研究背景

- 在基因组领域，**多基因预测（polygenic prediction／polygenic risk score, PRS）** 被广泛用于预测复杂性状或疾病风险。但目前许多方法依赖于 GWAS summary statistics 而忽略了功能基因组注释信息，这可能降低预测性能。 
- 此外，多数 PRS 方法在本族群（如欧洲人群）中表现较好，但在跨族群（跨人群 / 不同祖源）中的预测精度往往显著下降。作者希望通过整合功能注释和更全面的基因组覆盖（更多 SNP）来**提升跨人群和本族群内的预测能力**。
- 为此，作者提出一个新方法 **SBayesRC**，用于把 GWAS summary statistics 与功能注释整合起来，以改进复杂性状的 polygenic prediction。


---

## ⚙️ 二、方法原理（核心逻辑）

### 🧩 1. 模型概念：Bayesian multiple regression

SBayesRC 是 SBayesR 的扩展版。  
SBayesR 模型框架为：
<p align="center">
   <img src="https://latex.codecogs.com/svg.latex?\displaystyle\mathbf{y}=\mathbf{X}\boldsymbol{\beta}+\boldsymbol{\epsilon}">
</p>  

其中：
- $\mathbf{y}$：性状向量  
- $\mathbf{X}$：标准化基因型矩阵（GWAS 水平）  
- $\boldsymbol{\beta}$：SNP 效应向量  
- $\boldsymbol{\epsilon}$：残差项  

SBayesR 假设所有 SNP 的效应服从一个多组分混合正态分布：
<p align="center">
   <img src="https://latex.codecogs.com/svg.latex?\displaystyle\beta_j\sim\pi_0\delta_0+\sum_{k=1}^K\pi_k N(0,\sigma_k^2)">
</p>  

即：
- 以概率 $\pi_0$ 效应为零（非因果 SNP）；
- 以不同方差 $\sigma_k^2$ 捕捉不同规模的真实效应。

SBayesRC 在此基础上进一步让 **功能注释信息决定 $\pi_k$ 的分布**，即每个 SNP 属于哪一组、效应多大，不再是统一假设，而由注释驱动。

### 🧬 2. 核心创新：注释调控的层级贝叶斯模型

SBayesRC 将功能注释引入效应分布建模中：
<p align="center">
  <img src="https://latex.codecogs.com/svg.latex?%5Cdisplaystyle%5Cbeta_j%5Csim%5Cpi_0%5Cdelta_0%2B%5Csum_%7Bk%3D1%7D%5EK%5Cpi_kN(0,%5Csigma_k%5E2)">
</p>


其中 $f$ 是一个 logit 函数，用于建模注释特征（如是否位于 enhancer、promoter、保守区等）对 SNP 属于第 k 个混合成分的概率影响。

换言之：
> 每个 SNP 的因果概率与其功能注释特征相关。

这样模型能捕捉两类信息：
1. 注释决定该 SNP 是否更可能是“因果变异”；  
2. 注释同时影响该 SNP 可能具有的效应强度。

### 🧮 3. 贝叶斯推断与计算

模型通过改进版 Gibbs 采样进行贝叶斯估计，但为降低计算复杂度：
- 采用 **低秩近似 (low-rank approximation)** 表示 LD 矩阵；
- 使用大规模 MCMC 并行化策略；
- 在实际计算中可处理 7M 以上 SNP（大于标准 1M 基因组集）。

SBayesRC 输入可为：
- GWAS summary statistics；
- 参考 LD panel；
- 功能注释矩阵（约 96 个注释特征）。

输出包括：
- 每个 SNP 的后验效应估计；
- 基于注释的因果概率；
- 样本预测 PRS。

### 🧠 4. 注释 × 基因组覆盖交互

作者特别探讨了 SNP 覆盖密度对预测能力的影响。  
他们发现：  
> 当 SNP 密度增加（例如从 1M → 7M），模型对注释信息的敏感性增强，预测精度提升更显著。  

这表明注释和覆盖度之间存在交互作用：  
- 注释提供功能先验信息；  
- 高密度 SNP 数据提供遗传背景信息；  
两者结合可最大化捕获真实因果信号。

---

## 🧩 三、主要结果 / 结论

1. **SBayesRC 显著提升预测精度**  
   与基线方法 SBayesR（不使用注释）相比，在欧洲人群内部预测中平均提升约 14%；在跨人群 / 跨祖源预测中提升可达 34%。 
2. **在各种方法中具备竞争力 / 优越性**  
   相对于 LDpred2、LDpred-funct、MegaPRS、PolyPred-S、PRS-CSx 等方法，SBayesRC 在多个复杂性状 / 疾病上的表现常常优于或不逊色。
3. **注释 × SNP 密度交互效应**  
   注释信息的效益在 SNP 覆盖率高的情况下更显著：即当 SNP 数量更多、更密集时，功能注释能带来更大提升。 
4. **功能注释类别的贡献差异**  
   在功能分区分析中，进化保守 (evolutionarily constrained) 区域对预测精度的贡献很大；此外，**非同义 (nonsynonymous) SNP** 在每个 SNP 的平均贡献上比其他类别更高。
5. **模型资源 / 计算效率表现**  
   该模型在实际使用中可行：对 7M SNP + 96 注释的模拟 / 实验，所需资源和运行时间在可接受范围内。
6. **生物学 / 方法意义**  
   这篇工作表明，把功能注释纳入多 SNP 回归模型中，并扩展 SNP 覆盖率，是提升 polygenic prediction 的有效路径，尤其是在跨祖源或高密度 SNP 条件下。它还为未来结合全基因组测序 (whole-genome sequence) 数据 + 注释的预测方法提供了前瞻性思路。


---

## 💬 四、个人理解与启发

- 这篇文章是当前多基因预测领域一个非常有力的进展：它不仅在模型上更灵活（注释影响概率 + 效应大小），还在 SNP 密度层面做了扩展，从而提升跨人群预测能力。  
- 如果研究涉及PRS（尤其跨族群 / 多样本混合群体），可以考虑把类似 SBayesRC 的策略纳入模型设计中。  
- 尤其值得注意的是 **注释 × SNP 密度交互** 这个因素：说明如果你未来能拿到高密度 / 全基因组变异数据，那么注释信息将带来更大边际收益。  
- 在功能注释层面，这篇文章的分区分析也提醒，在选择注释集 / 特征时，可以优先考虑保守区域 / 非同义变异这类具有较强效应潜力的类别。  
- 若将来能整合更多类型注释（如表观遗传、3D 结构、细胞类型特异注释等）进入类似框架，有可能进一步提升预测性能。

---

## 📚 五、参考引用

> Zheng, Z., Liu, S., Sidorenko, J., et al. (2024). *Leveraging functional genomic annotations and genome coverage to improve polygenic prediction of complex traits within and between ancestries*. *Nature Genetics*, 56(5), 767–777. DOI: 10.1038/s41588-024-01704-y 

---

*最后更新：2025-10-17*
